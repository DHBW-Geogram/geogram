(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[1],{101:function(e,t,n){var r={"./ion-action-sheet.entry.js":[150,7],"./ion-alert.entry.js":[151,8],"./ion-app_8.entry.js":[152,9],"./ion-avatar_3.entry.js":[153,19],"./ion-back-button.entry.js":[154,20],"./ion-backdrop.entry.js":[155,45],"./ion-button_2.entry.js":[156,21],"./ion-card_5.entry.js":[157,22],"./ion-checkbox.entry.js":[158,23],"./ion-chip.entry.js":[159,24],"./ion-col_3.entry.js":[160,46],"./ion-datetime_3.entry.js":[161,12],"./ion-fab_3.entry.js":[162,25],"./ion-img.entry.js":[163,47],"./ion-infinite-scroll_2.entry.js":[164,48],"./ion-input.entry.js":[165,26],"./ion-item-option_3.entry.js":[166,27],"./ion-item_8.entry.js":[167,28],"./ion-loading.entry.js":[168,29],"./ion-menu_3.entry.js":[169,30],"./ion-modal.entry.js":[170,10],"./ion-nav_2.entry.js":[171,16],"./ion-popover.entry.js":[172,11],"./ion-progress-bar.entry.js":[173,31],"./ion-radio_2.entry.js":[174,32],"./ion-range.entry.js":[175,33],"./ion-refresher_2.entry.js":[176,13],"./ion-reorder_2.entry.js":[177,18],"./ion-ripple-effect.entry.js":[178,49],"./ion-route_4.entry.js":[179,34],"./ion-searchbar.entry.js":[180,35],"./ion-segment_2.entry.js":[181,36],"./ion-select_3.entry.js":[182,37],"./ion-slide_2.entry.js":[183,50],"./ion-spinner.entry.js":[184,15],"./ion-split-pane.entry.js":[185,51],"./ion-tab-bar_2.entry.js":[186,38],"./ion-tab_2.entry.js":[187,17],"./ion-text.entry.js":[188,39],"./ion-textarea.entry.js":[189,40],"./ion-toast.entry.js":[190,41],"./ion-toggle.entry.js":[191,14],"./ion-virtual-scroll.entry.js":[192,52]};function c(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],c=t[0];return n.e(t[1]).then((function(){return n(c)}))}c.keys=function(){return Object.keys(r)},c.id=101,e.exports=c},103:function(e,t,n){var r={"./ion-icon.entry.js":[193,67]};function c(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],c=t[0];return n.e(t[1]).then((function(){return n(c)}))}c.keys=function(){return Object.keys(r)},c.id=103,e.exports=c},105:function(e,t,n){},143:function(e,t,n){},144:function(e,t,n){},145:function(e,t,n){},146:function(e,t,n){},147:function(e,t,n){var r={"./pwa-action-sheet.entry.js":[197,59],"./pwa-camera-modal-instance.entry.js":[198,60],"./pwa-camera-modal.entry.js":[199,61],"./pwa-camera.entry.js":[200,62],"./pwa-toast.entry.js":[201,63]};function c(e){if(!n.o(r,e))return Promise.resolve().then((function(){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=r[e],c=t[0];return n.e(t[1]).then((function(){return n(c)}))}c.keys=function(){return Object.keys(r)},c.id=147,e.exports=c},148:function(e,t,n){"use strict";n.r(t),n.d(t,"UserContext",(function(){return Ce})),n.d(t,"UserProvider",(function(){return Ee}));var r=n(7),c=n(41),i=n.n(c),a=n(25),s=n(26),o=n(2),l=n(5),u=n.n(l),j=n(8),d=n(4),b=n(93),h=n(42),O=n(61),x=n(17),f=(x.f.Filesystem,"photos");function p(){var e=Object(o.useState)(),t=Object(r.a)(e,2),n=t[0],c=t[1],i=Object(b.a)().getPhoto,a=Object(h.b)(),s=(a.deleteFile,a.readFile),l=a.writeFile,p=Object(O.a)(),v=p.get,m=p.set;Object(o.useEffect)((function(){}),[v,s]);var g=function(){var e=Object(j.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i({resultType:x.a.Uri,source:x.b.Camera,quality:25});case 2:return t=e.sent,n=(new Date).getTime()+".jpeg",e.next=6,k(t,n);case 6:return r=e.sent,c(r),m(f,JSON.stringify(r)),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),y=function(){var e=Object(j.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e,n){var r=new FileReader;r.onerror=n,r.onload=function(){return e(r.result)},r.readAsDataURL(t)})));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),w=function(){var e=Object(j.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,i({resultType:x.a.Uri,source:x.b.Photos,quality:25});case 2:return t=e.sent,n=(new Date).getTime()+".jpeg",e.next=6,k(t,n);case 6:return r=e.sent,c(r),m(f,JSON.stringify(r)),e.abrupt("return",r);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=function(){var e=Object(j.a)(u.a.mark((function e(t,n){var r,c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Object(d.bb)("hybrid")){e.next=7;break}return e.next=3,s({path:t.path});case 3:c=e.sent,r=c.data,e.next=10;break;case 7:return e.next=9,Object(h.a)(t.webPath);case 9:r=e.sent;case 10:return e.next=12,l({path:n,data:r,directory:x.d.Data});case 12:if(i=e.sent,!Object(d.bb)("hybrid")){e.next=17;break}return e.abrupt("return",{filepath:i.uri,webviewPath:x.c.convertFileSrc(i.uri)});case 17:return e.abrupt("return",{filepath:n,webviewPath:t.webPath,data:r});case 18:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return{photo:n,takePhoto:g,takePhotoFromGalerie:w,convertBlobToBase64:y}}var v=n(205),m=n(209),g=n(206),y=n(207),w=(n(104),n(105),n(0)),k=function(e){var t=e.location;return Object(w.jsxs)(v.a,{center:[t.coords.latitude,t.coords.longitude],zoom:13,scrollWheelZoom:!1,style:{height:"20vh",width:"100vh"},children:[Object(w.jsx)(m.a,{attribution:'\xa9 <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),Object(w.jsx)(g.a,{position:[t.coords.latitude,t.coords.longitude],children:Object(w.jsx)(y.a,{children:"Current Position."})})]})},S=n(56),C=n.n(S),E=n(70),P=E.a.initializeApp({apiKey:"AIzaSyCuOUn1kd_QKs91UYx2Pv015QYAwNfpkWg",authDomain:"geogram-4906f.firebaseapp.com",projectId:"geogram-4906f",storageBucket:"geogram-4906f.appspot.com",messagingSenderId:"293875577588",appId:"1:293875577588:web:d286bacade6e4850bfa4a1"}),L=P.firestore(),D=P.auth();E.a;D.onAuthStateChanged((function(e){if(e){var t=e.uid;localStorage.setItem("uid",t),console.log("RES:",D)}else localStorage.removeItem("uid")}));var U=n(208),F=x.f.Geolocation,I=x.f.Filesystem,A=function(e){var t=Object(o.useContext)(Ce),n=(Object(O.a)().get,Object(h.b)()),c=(n.deleteFile,n.readFile,n.writeFile,p().convertBlobToBase64,Object(o.useState)()),i=Object(r.a)(c,2),l=i[0],b=i[1],f=Object(o.useState)(""),v=Object(r.a)(f,2),m=v[0],g=v[1],y=Object(o.useState)(""),S=Object(r.a)(y,2),E=S[0],P=S[1],D=Object(o.useState)(),A=Object(r.a)(D,2),N=A[0],R=A[1],z=Object(o.useState)(""),_=Object(r.a)(z,2),T=_[0],B=_[1],J=Object(o.useState)(""),M=Object(r.a)(J,2),q=M[0],Q=M[1],W=Object(o.useState)(""),G=Object(r.a)(W,2),K=G[0],V=G[1],Y=Object(o.useState)(""),Z=Object(r.a)(Y,2),H=Z[0];Z[1];Object(o.useEffect)((function(){void 0!==e.location.state&&b(e.location.state.image),F.getCurrentPosition().then((function(e){R({coords:{accuracy:e.coords.accuracy,altitude:e.coords.altitude,altitudeAccuracy:e.coords.altitudeAccuracy,heading:e.coords.heading,latitude:e.coords.latitude,longitude:e.coords.longitude,speed:e.coords.speed},timestamp:e.timestamp}),C.a.get("https://api.opencagedata.com/geocode/v1/json?q=".concat(null===e||void 0===e?void 0:e.coords.latitude,"+").concat(null===e||void 0===e?void 0:e.coords.longitude,"&key=bb44e70b618844faba7cb23b580419e0")).then((function(e){B(e.data.results[0].formatted),R((function(t){return Object(a.a)(Object(a.a)({},t),{},{position:e.data.results[0].formatted})}))}))})),e.setLoading(!1)}),[e.location.state]);var $=function(){var n=Object(j.a)(u.a.mark((function n(){var r,c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.setLoading(!0),void 0===N&&R({coords:{accuracy:0,altitude:0,altitudeAccuracy:0,heading:0,latitude:0,longitude:0,speed:0},timestamp:Date.now()}),""===m||""===E||void 0===l){n.next=24;break}if(void 0===l.webviewPath){n.next=22;break}if(!Object(d.bb)("android")&&!Object(d.bb)("ios")){n.next=15;break}return n.t0=a.a,n.t1=Object(a.a)({},r),n.t2={},n.next=10,Object(h.a)(l.webviewPath);case 10:n.t3=n.sent.toString().split(",")[1],n.t4={data:n.t3},r=(0,n.t0)(n.t1,n.t2,n.t4),n.next=18;break;case 15:return n.next=17,I.readFile({path:l.filepath,directory:x.d.Data,encoding:x.e.UTF8});case 17:r=n.sent;case 18:return n.next=20,C.a.post("".concat("https://api.dhbw-geogram.de","/upload1"),{data:r.data});case 20:void 0!==(c=n.sent).data.file?L.collection("users").doc(null===t||void 0===t?void 0:t.uid).get().then((function(n){var r,i=Object(U.a)();L.collection("images").doc(i).set({id:i,timestamp:Date.now(),user:(null===(r=n.data())||void 0===r?void 0:r.username)||(null===t||void 0===t?void 0:t.email),location:N,url:"".concat("https://api.dhbw-geogram.de","/").concat(c.data.file),title:m,description:E}).then((function(t){Q("Successfully added item to firebase"),g(""),P(""),b(void 0),R(void 0),setTimeout((function(){V("explore"),e.setLoading(!1)}),1e3)})).catch((function(e){return Q("Error while adding data to firebase")}))})):Q("Error while adding data to image server: https://api.dhbw-geogram.de");case 22:n.next=25;break;case 24:Q(""===m?"Please fill out the title field!":""===E?"Please fill out the description field!":"Error occured!");case 25:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return Object(w.jsxs)(d.B,{children:[Object(w.jsx)(d.r,{children:Object(w.jsx)(d.S,{children:Object(w.jsx)(d.Q,{children:"Upload"})})}),Object(w.jsxs)(d.n,{fullscreen:!0,children:[Object(w.jsx)(d.r,{collapse:"condense",children:Object(w.jsx)(d.S,{children:Object(w.jsx)(d.Q,{size:"large",children:"Upload"})})}),l&&Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(d.t,{src:l.webviewPath}),Object(w.jsxs)(d.q,{children:[Object(w.jsx)(d.J,{children:Object(w.jsx)(d.m,{size:"12",children:Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"floating",children:"Title"}),Object(w.jsx)(d.u,{type:"text",value:m,onIonChange:function(e){g(e.detail.value)}})]})})}),Object(w.jsx)(d.J,{children:Object(w.jsx)(d.m,{size:"12",children:Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"floating",children:"Description"}),Object(w.jsx)(d.P,{value:E,onIonChange:function(e){P(e.detail.value)}})]})})}),Object(w.jsx)(d.J,{children:Object(w.jsxs)(d.m,{size:"12",children:["Current Position: Latitude:"," ",null===N||void 0===N?void 0:N.coords.latitude.toString(),", Longitude:"," ",null===N||void 0===N?void 0:N.coords.longitude.toString()]})}),Object(w.jsx)(d.J,{children:Object(w.jsxs)(d.m,{size:"12",children:["City: ",T]})}),Object(w.jsx)(d.J,{children:Object(w.jsx)(d.m,{size:"12",children:N&&Object(w.jsx)(k,{location:N})})}),Object(w.jsxs)(d.J,{children:[Object(w.jsx)(d.m,{children:Object(w.jsx)(d.e,{expand:"block",shape:"round",fill:"outline",color:"primary",onClick:$,children:"Submit"})}),Object(w.jsx)(d.m,{children:Object(w.jsx)(d.e,{expand:"block",shape:"round",fill:"outline",color:"danger",onClick:function(){g(""),P(""),b(void 0),R(void 0),V("explore")},children:"Cancel"})})]}),Object(w.jsx)(d.J,{children:Object(w.jsx)(d.m,{size:"12",children:Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"floating",children:"Log"}),Object(w.jsx)(d.P,{value:H})]})})})]})]}),Object(w.jsx)(d.R,{isOpen:""!==q,onDidDismiss:function(){return Q("")},message:q,duration:1500}),""!==K&&Object(w.jsx)(s.a,{to:"/".concat(K)})]})]})},N=n(69),R=n(14),z=function(e){var t=e.active,n=e.setShowActionSheet,c=e.setLoading,i=Object(o.useState)(""),a=Object(r.a)(i,2),l=a[0],u=a[1],j=Object(o.useState)(),b=Object(r.a)(j,2),h=b[0],O=b[1],x=p(),f=x.takePhoto,v=x.takePhotoFromGalerie;return Object(w.jsxs)(w.Fragment,{children:["profile-pic"===l&&Object(w.jsx)(s.a,{to:{pathname:"/profile-pic",state:{image:h}}}),Object(w.jsx)(d.a,{isOpen:t,onDidDismiss:function(){return n(!1)},buttons:[{text:"Camera",icon:R.c,handler:function(){f().then((function(e){c(!0),O(e),u("profile-pic")})).catch((function(e){console.log(e)}))}},{text:"Galerie",icon:R.o,handler:function(){v().then((function(e){c(!0),O(e),u("profile-pic")}))}},{text:"Close",icon:R.k,handler:function(){n(!1)}}]})]})};function _(e){return T.apply(this,arguments)}function T(){return(T=Object(j.a)(u.a.mark((function e(t){var n,r,c,i,a,s,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=L.collection("users"),e.next=3,r.get();case 3:return c=e.sent,i=[],c.docs.forEach((function(e){return i.push(e.data().username)})),a=i.length,s="",e.next=10,L.collection("users").where("email","==",null===(n=D.currentUser)||void 0===n?void 0:n.email).get().then((function(e){e.forEach((function(e){s=e.data().username}))}));case 10:o=0;case 11:if(!(o<a)){e.next=17;break}if((i[o]!==t||s==t)&&""!=t){e.next=14;break}return e.abrupt("return",!0);case 14:o++,e.next=11;break;case 17:return e.abrupt("return",!1);case 18:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var B=function(e){var t=e.setLoading,n=Object(o.useState)(!1),c=Object(r.a)(n,2),i=c[0],a=c[1],s=Object(o.useState)(!1),l=Object(r.a)(s,2),b=l[0],h=l[1],O=Object(o.useState)(),x=Object(r.a)(O,2),f=x[0],p=x[1],v=Object(o.useState)(),m=Object(r.a)(v,2),g=m[0],y=m[1],k=Object(o.useState)(),S=Object(r.a)(k,2),C=S[0],E=S[1],P=Object(o.useState)(),U=Object(r.a)(P,2),F=U[0],I=U[1],A=Object(o.useState)(),N=Object(r.a)(A,2),R=N[0],T=N[1],B=Object(o.useState)(!1),J=Object(r.a)(B,2),M=J[0],q=J[1],Q=Object(o.useState)(""),W=Object(r.a)(Q,2),G=W[0],K=W[1],V=Object(o.useState)(void 0),Y=Object(r.a)(V,2),Z=Y[0],H=Y[1],$=Object(o.useState)(""),X=Object(r.a)($,2),ee=X[0],te=X[1],ne=Object(o.useState)(""),re=Object(r.a)(ne,2),ce=re[0],ie=re[1],ae=!0,se=Object(o.useState)(""),oe=Object(r.a)(se,2),le=oe[0],ue=oe[1],je=Object(o.useState)(""),de=Object(r.a)(je,2),be=de[0],he=de[1],Oe=Object(o.useState)(!0),xe=Object(r.a)(Oe,2),fe=(xe[0],xe[1]);return Object(o.useEffect)((function(){var e;L.collection("users").where("email","==",null===(e=D.currentUser)||void 0===e?void 0:e.email).get().then((function(e){e.forEach((function(e){H(e.data().profilepic),p(e.data().username),I(e.data().email),y(e.data().userFirstName),E(e.data().userLastName),T(e.data().biography)}))}))}),[b]),Object(o.useEffect)((function(){var e;(null===(e=D.currentUser)||void 0===e?void 0:e.emailVerified)?K("none"):K("")})),Object(w.jsxs)(d.B,{children:[Object(w.jsx)(d.r,{children:Object(w.jsx)(d.S,{children:Object(w.jsx)(d.Q,{children:"Profile"})})}),Object(w.jsxs)(d.n,{fullscreen:!0,children:[Object(w.jsxs)(d.q,{children:[Object(w.jsx)(d.J,{children:Object(w.jsx)(d.m,{children:Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.d,{slot:"start",style:{height:"100px",width:"100px"},onClick:function(){a(!0)},children:Object(w.jsx)(d.t,{src:Z||"https://im-coder.com/images4/15590312779219.png"})}),Object(w.jsx)(z,{active:i,setShowActionSheet:a,setLoading:t}),Object(w.jsxs)(d.q,{children:[Object(w.jsxs)(d.J,{children:[Object(w.jsx)(d.m,{style:{textAlign:"center"},children:"14"}),Object(w.jsx)(d.m,{style:{textAlign:"center"},children:"3"})]}),Object(w.jsxs)(d.J,{children:[Object(w.jsx)(d.m,{style:{textAlign:"center"},children:"Likes"}),Object(w.jsx)(d.m,{style:{textAlign:"center"},children:"Beitr\xe4ge"})]})]})]})})}),Object(w.jsx)(d.J,{children:Object(w.jsx)(d.m,{children:Object(w.jsx)(d.v,{children:Object(w.jsxs)(d.q,{style:{paddingLeft:"0px"},children:[Object(w.jsx)(d.J,{children:Object(w.jsx)(d.m,{children:Object(w.jsx)(d.w,{style:{fontSize:"20px"},children:f})})}),Object(w.jsx)(d.J,{children:Object(w.jsx)(d.m,{children:Object(w.jsx)(d.w,{className:"ion-text-wrap",style:{fontSize:"15px"},children:R})})})]})})})}),Object(w.jsxs)(d.J,{children:[Object(w.jsx)(d.m,{style:{textAlign:"center"},children:Object(w.jsx)(d.e,{shape:"round",fill:"outline",color:"primary",onClick:function(){return h(!0)},children:"Edit Profile"})}),Object(w.jsx)(d.m,{style:{textAlign:"center",display:String(G)},children:Object(w.jsx)(d.e,{shape:"round",fill:"outline",color:"danger",onClick:Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return q(!0),e.next=3,null===(t=D.currentUser)||void 0===t?void 0:t.sendEmailVerification();case 3:case"end":return e.stop()}}),e)}))),children:"Verify Email"})})]})]}),Object(w.jsx)(d.b,{isOpen:M,onDidDismiss:function(){return q(!1)},cssClass:"my-custom-class",header:"Verify E-Mail",message:"Email was sent to you to verify your email.",buttons:["OK"]}),Object(w.jsxs)(d.A,{isOpen:b,children:[Object(w.jsx)(d.r,{children:Object(w.jsxs)(d.S,{children:[Object(w.jsx)(d.f,{slot:"end",children:Object(w.jsx)(d.e,{color:"primary",onClick:function(){h(!1),ue(""),he(""),te(""),ie("")},children:"Close"})}),Object(w.jsx)(d.Q,{children:"Edit Profile"})]})}),Object(w.jsxs)(d.n,{fullscreen:!0,children:[Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{color:ee,position:"floating",children:"Username"}),Object(w.jsx)(d.u,{color:ce,value:f,type:"text",onIonChange:function(){var e=Object(j.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",p(t.detail.value));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()})]}),Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"floating",children:"First Name"}),Object(w.jsx)(d.u,{value:g,type:"text",onIonChange:function(e){return y(e.detail.value)}})]}),Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"floating",children:"Last Name"}),Object(w.jsx)(d.u,{value:C,type:"text",onIonChange:function(e){return E(e.detail.value)}})]}),Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{color:le,position:"floating",children:"E-Mail"}),Object(w.jsx)(d.u,{color:be,value:F,type:"email",onIonChange:function(e){return I(e.detail.value)}})]}),Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"stacked",children:"Biography"}),Object(w.jsx)(d.P,{value:R,onIonChange:function(e){return T(e.detail.value)}})]}),Object(w.jsxs)(d.q,{children:[Object(w.jsxs)(d.J,{children:[Object(w.jsx)(d.m,{style:{textAlign:"center"},children:Object(w.jsx)(d.e,{expand:"block",shape:"round",fill:"outline",color:"primary",onClick:function(){h(!1),ue(""),he(""),te(""),ie("")},children:"Cancel"})}),Object(w.jsx)(d.m,{style:{textAlign:"center"},children:Object(w.jsx)(d.e,{expand:"block",shape:"round",fill:"outline",color:"primary",onClick:Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return ae=!0,fe(!0),t={username:f,userFirstName:g,userLastName:C,email:F,biography:R},e.next=5,_(f).then(function(){var e=Object(j.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t?(te("danger"),ie("danger"),ae=!1):(te(""),ie(""),ae=!0);case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).then(Object(j.a)(u.a.mark((function e(){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(F==(null===(n=D.currentUser)||void 0===n?void 0:n.email)){e.next=5;break}return e.next=3,null===(r=D.currentUser)||void 0===r?void 0:r.updateEmail(String(F)).then(Object(j.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Email-Update successfull!"),fe(!0),e.next=4,null===(n=D.currentUser)||void 0===n?void 0:n.sendEmailVerification().then(Object(j.a)(u.a.mark((function e(){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("Send Email successfull!"),ue(""),he(""),!ae){e.next=9;break}return te(""),ie(""),e.next=8,L.collection("users").doc(null===(n=D.currentUser)||void 0===n?void 0:n.uid).set(t);case 8:h(!1);case 9:case"end":return e.stop()}}),e)})))).catch((function(e){console.log("Send Email ERROR!")}));case 4:case"end":return e.stop()}}),e)})))).catch((function(e){console.log("Email-Update ERROR!"),ue("danger"),he("danger"),fe(!1)}));case 3:e.next=13;break;case 5:if(!ae){e.next=13;break}return te(""),ie(""),ue(""),he(""),e.next=12,L.collection("users").doc(null===(c=D.currentUser)||void 0===c?void 0:c.uid).set(t);case 12:h(!1);case 13:case"end":return e.stop()}}),e)}))));case 5:case"end":return e.stop()}}),e)}))),children:"Save"})})]}),Object(w.jsx)(d.J,{children:Object(w.jsx)(d.m,{style:{textAlign:"center"},children:Object(w.jsx)(d.e,{shape:"round",fill:"outline",color:"danger",onClick:function(){return D.signOut()},children:"Logout"})})})]})]})]})]})]})},J=(n(133),n(134),n(135),n(136),n(137),n(138),n(139),n(140),n(141),n(142),n(143),function(e){var t=e.active,n=e.setShowActionSheet,c=e.setLoading,i=Object(o.useState)(""),a=Object(r.a)(i,2),l=a[0],u=a[1],j=Object(o.useState)(),b=Object(r.a)(j,2),h=b[0],O=b[1],x=p(),f=x.takePhoto,v=x.takePhotoFromGalerie;return Object(w.jsxs)(w.Fragment,{children:["upload"===l&&Object(w.jsx)(s.a,{to:{pathname:"/upload",state:{image:h}}}),Object(w.jsx)(d.a,{isOpen:t,onDidDismiss:function(){return n(!1)},buttons:[{text:"Camera",icon:R.c,handler:function(){f().then((function(e){c(!0),O(e),u("upload")})).catch((function(e){console.log(e)}))}},{text:"Galerie",icon:R.o,handler:function(){v().then((function(e){c(!0),O(e),u("upload")}))}},{text:"Close",icon:R.k,handler:function(){n(!1)}}]})]})});function M(e){return e*Math.PI/180}function q(e,t,n,r){var c=M(n-e),i=M(r-t);e=M(e),n=M(n);var a=Math.sin(c/2)*Math.sin(c/2)+Math.sin(i/2)*Math.sin(i/2)*Math.cos(e)*Math.cos(n);return 6371*(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)))}var Q=function(e){var t=e.image;return Object(w.jsxs)(d.g,{className:"my-ion-card",children:[Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.s,{icon:R.u,slot:"start"}),Object(w.jsx)(d.w,{children:t.location.position?t.location.position:t.location.coords.latitude+" "+t.location.coords.longitude})]}),t.distance?Object(w.jsx)(d.v,{children:Object(w.jsx)(d.w,{children:"".concat(t.distance.toString().slice(0,4)," km away from you")})}):Object(w.jsx)(d.v,{children:Object(w.jsx)(d.w,{children:"Near you"})}),Object(w.jsxs)(d.i,{children:[Object(w.jsx)(d.j,{children:t.user}),Object(w.jsx)(d.k,{children:t.title})]}),Object(w.jsxs)(d.h,{children:[Object(w.jsx)(d.t,{src:t.url}),Object(w.jsx)("br",{}),Object(w.jsx)(d.O,{style:{fontSize:"large"},children:t.description})]})]})},W=(n(144),x.f.Geolocation),G=function(){var e=Object(o.useState)("Location"),t=Object(r.a)(e,2),n=t[0],c=t[1],i=Object(o.useState)([]),a=Object(r.a)(i,2),s=a[0],l=a[1],b=Object(o.useState)(!1),h=Object(r.a)(b,2),O=h[0],x=h[1],f=Object(o.useState)(),p=Object(r.a)(f,2),v=p[0],m=p[1],g=Object(o.useState)(),y=Object(r.a)(g,2),k=y[0],S=y[1];function C(){return E.apply(this,arguments)}function E(){return(E=Object(j.a)(u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=L.collection("images"),e.next=3,t.get();case 3:return n=e.sent,r=[],n.docs.forEach((function(e){return r.push(e.data())})),r.forEach((function(e){void 0!==k&&void 0==e.distance&&(e.distance=q(null===k||void 0===k?void 0:k.coords.latitude,null===k||void 0===k?void 0:k.coords.longitude,e.location.coords.latitude,e.location.coords.longitude))})),e.abrupt("return",r);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(o.useEffect)((function(){Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=S,e.next=3,W.getCurrentPosition();case 3:return e.t1=e.sent,(0,e.t0)(e.t1),console.log("Initial load..."),e.t2=l,e.next=9,C();case 9:e.t3=e.sent,(0,e.t2)(e.t3);case 11:case"end":return e.stop()}}),e)})))()}),[]),Object(w.jsxs)(d.B,{children:[Object(w.jsx)(d.r,{children:Object(w.jsx)(d.S,{children:Object(w.jsx)(d.Q,{children:"Search"})})}),Object(w.jsxs)(d.n,{fullscreen:!0,children:[Object(w.jsx)(d.K,{onIonChange:function(e){var t;t=e.target.value,console.log("filtering",t),""===t||null===t||void 0===t?C().then((function(e){l(e)})):"Location"===n?C().then((function(e){var n=[];e.forEach((function(e){var r;(null===(r=e.location.position)||void 0===r?void 0:r.includes(t))&&n.push(e)})),l(n)})):"Title"===n?C().then((function(e){var n=[];e.forEach((function(e){e.title.includes(t)&&n.push(e)})),l(n)})):"User"===n&&C().then((function(e){var n=[];e.forEach((function(e){e.user.includes(t)&&n.push(e)})),l(n)}))},showCancelButton:"never"}),Object(w.jsxs)(d.y,{children:["Filter: ",n]}),Object(w.jsx)(d.l,{style:"Location"===n?{backgroundColor:"lightgray",color:"black"}:{},onClick:function(e){c("Location")},children:Object(w.jsx)(d.w,{children:"Location"})}),Object(w.jsx)(d.l,{style:"User"===n?{backgroundColor:"lightgray",color:"black"}:{},onClick:function(e){c("User")},children:Object(w.jsx)(d.w,{children:"User"})}),Object(w.jsx)(d.l,{style:"Title"===n?{backgroundColor:"lightgray",color:"black"}:{},onClick:function(e){c("Title")},children:Object(w.jsx)(d.w,{children:"Title"})}),Object(w.jsx)(d.q,{children:Object(w.jsx)(d.J,{children:s.map((function(e){var t;return Object(w.jsxs)(d.m,{size:"4",children:[Object(w.jsx)(d.t,{onClick:function(t){x(!0),m(e)},src:e.url,style:{objectFit:"cover",height:"100%",width:"100%"}}),Object(w.jsxs)("p",{style:{position:"absolute",bottom:"-10px",right:"10px",backgroundColor:"rgba(0,0,0,0.5)",borderRadius:"5px"},children:[null===(t=e.distance)||void 0===t?void 0:t.toPrecision(4),"km"]})]})}))})}),Object(w.jsx)(d.C,{cssClass:"my-pop-over",backdropDismiss:!0,showBackdrop:!1,isOpen:O,onDidDismiss:function(e){return x(!1)},children:v&&Object(w.jsx)(Q,{image:v})})]})]})};n(145),n(86);function K(e){return V.apply(this,arguments)}function V(){return(V=Object(j.a)(u.a.mark((function e(t){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=document.createElement("ion-alert")).message=t,n.buttons=["OK"],document.body.appendChild(n),e.next=6,n.present();case 6:return e.next=8,n.onDidDismiss();case 8:r=e.sent,c=r.role,console.log("onDidDismiss resolved with role",c);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Y(e,t){return Z.apply(this,arguments)}function Z(){return(Z=Object(j.a)(u.a.mark((function e(t,n){var r,c,i;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(r=document.createElement("ion-alert")).header=n,r.message=t,r.buttons=["OK"],document.body.appendChild(r),e.next=7,r.present();case 7:return e.next=9,r.onDidDismiss();case 9:c=e.sent,i=c.role,console.log("onDidDismiss resolved with role",i);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(e){return $.apply(this,arguments)}function $(){return($=Object(j.a)(u.a.mark((function e(t){var n,r,c,i,a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=L.collection("users"),e.next=3,n.get();case 3:r=e.sent,c=[],r.docs.forEach((function(e){return c.push(e.data().username)})),i=c.length,a=0;case 8:if(!(a<i)){e.next=14;break}if(c[a]!==t){e.next=11;break}return e.abrupt("return",!0);case 11:a++,e.next=8;break;case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function X(e,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(j.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,H(t);case 2:if(!e.sent){e.next=7;break}return e.next=5,L.collection("users").where("username","==",t).get().then((function(e){e.forEach(function(){var e=Object(j.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.signInWithEmailAndPassword(t.data().email,n).catch((function(e){return K("Your Login credentials are incorrect")}));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}));case 5:e.next=9;break;case 7:return e.next=9,D.signInWithEmailAndPassword(t,n).catch((function(e){return K("Your Login credentials are incorrect")}));case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function te(e,t){return ne.apply(this,arguments)}function ne(){return(ne=Object(j.a)(u.a.mark((function e(t,n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==t.length){e.next=4;break}K("Email or Username Required"),e.next=10;break;case 4:if(0!==n.length){e.next=8;break}K("Password Required"),e.next=10;break;case 8:return e.next=10,X(t,n);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re,ce=function(){var e=Object(o.useState)(""),t=Object(r.a)(e,2),n=t[0],c=t[1],i=Object(o.useState)(""),a=Object(r.a)(i,2),s=a[0],l=a[1],b=Object(o.useState)(!1),h=Object(r.a)(b,2),O=h[0],x=h[1],f=Object(o.useCallback)((function(e){var t;return c(null===(t=e.detail)||void 0===t?void 0:t.value)}),[]),p=Object(o.useCallback)((function(e){var t;return l(null===(t=e.detail)||void 0===t?void 0:t.value)}),[]),v=Object(o.useCallback)(Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,te(n,s);case 2:case"end":return e.stop()}}),e)}))),[n,s]);return Object(w.jsxs)(d.B,{children:[Object(w.jsx)(d.r,{children:Object(w.jsx)(d.S,{children:Object(w.jsx)(d.Q,{children:"Login"})})}),Object(w.jsx)(d.n,{fullscreen:!0,children:Object(w.jsxs)(d.q,{children:[Object(w.jsx)("br",{}),Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"floating",children:"Email or Username"}),Object(w.jsx)(d.u,{onIonChange:f,value:n,class:"input",type:"text"})]}),Object(w.jsx)("br",{}),Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"floating",children:"Password"}),Object(w.jsx)(d.u,{onIonChange:p,value:s,type:"password"})]}),Object(w.jsx)("br",{}),Object(w.jsx)("div",{className:"LogInButton",children:Object(w.jsxs)(d.e,{onClick:v,expand:"block",children:["Login",Object(w.jsx)(d.s,{icon:R.p})]})}),Object(w.jsx)("br",{}),Object(w.jsx)("br",{}),Object(w.jsx)("br",{}),Object(w.jsx)("div",{className:"LogInButton",children:Object(w.jsx)(d.H,{routerLink:"/register",children:"CREATE A NEW ACCOUNT"})}),Object(w.jsx)("br",{}),Object(w.jsx)("div",{className:"LogInButton",children:Object(w.jsx)(d.H,{onClick:function(){return x(!0)},children:"I FORGOT MY PASSWORD"})})]})}),Object(w.jsx)(d.b,{isOpen:O,onDidDismiss:function(){return x(!1)},message:"Please Type In your Email",inputs:[{name:"emailPasswordForgoten",type:"email",placeholder:"Email"}],buttons:[{text:"Send",handler:function(e){D.sendPasswordResetEmail(e.emailPasswordForgoten)}}]})]})},ie=(n(146),n(15)),ae=n(16);!function(e){e[e.Short=0]="Short",e[e.Common=1]="Common",e[e.Weak=2]="Weak",e[e.Ok=3]="Ok",e[e.Strong=4]="Strong"}(re||(re={}));var se=function(){function e(){Object(ie.a)(this,e),this.commonPasswordPatterns=/passw.*|12345.*|09876.*|qwert.*|asdfg.*|zxcvb.*|footb.*|baseb.*|drago.*/}return Object(ae.a)(e,[{key:"isPasswordCommon",value:function(e){return this.commonPasswordPatterns.test(e)}},{key:"checkPasswordStrength",value:function(t){var n=0;n=/.*[a-z].*/.test(t)?++n:n,n=/.*[A-Z].*/.test(t)?++n:n,n=/.*[0-9].*/.test(t)?++n:n,n=/[^a-zA-Z0-9]/.test(t)?++n:n;re.Short;return null===t||t.length<e.MinimumLength?re.Short:!0===this.isPasswordCommon(t)?re.Common:0===n||1===n||2===n?re.Weak:3===n?re.Ok:re.Strong}}],[{key:"MinimumLength",get:function(){return 5}}]),e}();function oe(){return le.apply(this,arguments)}function le(){return(le=Object(j.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:null===(t=D.currentUser)||void 0===t||t.sendEmailVerification();case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e,t,n,r,c){return je.apply(this,arguments)}function je(){return(je=Object(j.a)(u.a.mark((function e(t,n,r,c,i){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,D.createUserWithEmailAndPassword(n,t).then(function(){var e=Object(j.a)(u.a.mark((function e(t){var a,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.user,oe(),new Date,s={username:i,userFirstName:r,userLastName:c,email:n},e.next=6,L.collection("users").doc(null===(a=D.currentUser)||void 0===a?void 0:a.uid).set(s).catch((function(e){return K(e.message)}));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()).catch((function(e){return K(e.message)}));case 2:return e.abrupt("return","");case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e,t,n,r,c,i){return be.apply(this,arguments)}function be(){return(be=Object(j.a)(u.a.mark((function e(t,n,r,c,i,a){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0!==a.length){e.next=4;break}K("Username Required"),e.next=36;break;case 4:return e.next=6,H(a);case 6:if(!e.sent){e.next=10;break}K("Username already taken"),e.next=36;break;case 10:if(0!==c.length){e.next=14;break}K("Firstname Required"),e.next=36;break;case 14:if(0!==i.length){e.next=18;break}K("Secondname Required"),e.next=36;break;case 18:if(0!==r.length){e.next=22;break}K("Email Required"),e.next=36;break;case 22:if(0!==n.length){e.next=26;break}K("Password Required"),e.next=36;break;case 26:if(!(n.length<6)){e.next=30;break}K("Password to short"),e.next=36;break;case 30:if(t===n){e.next=34;break}K("Password don't match"),e.next=36;break;case 34:return e.next=36,ue(n,r,c,i,a);case 36:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var he=function(){var e=Object(o.useState)(""),t=Object(r.a)(e,2),n=t[0],c=t[1],i=Object(o.useState)(""),a=Object(r.a)(i,2),s=a[0],l=a[1],b=Object(o.useState)(""),h=Object(r.a)(b,2),O=h[0],x=h[1],f=Object(o.useState)(""),p=Object(r.a)(f,2),v=p[0],m=p[1],g=Object(o.useState)(""),y=Object(r.a)(g,2),k=y[0],S=y[1],C=Object(o.useState)(""),E=Object(r.a)(C,2),P=E[0],L=E[1],U=Object(o.useState)(""),F=Object(r.a)(U,2),I=(F[0],F[1]),A=Object(o.useState)(!1),N=Object(r.a)(A,2),z=(N[0],N[1],Object(o.useState)(re.Short)),_=Object(r.a)(z,2),T=_[0],B=_[1],J=new se,M=Object(o.useCallback)((function(e){var t;return c(null===(t=e.detail)||void 0===t?void 0:t.value)}),[]),q=Object(o.useCallback)((function(e){var t,n;m(null===(t=e.detail)||void 0===t?void 0:t.value),B(J.checkPasswordStrength(null===(n=e.detail)||void 0===n?void 0:n.value))}),[]),Q=Object(o.useCallback)((function(e){var t;return S(null===(t=e.detail)||void 0===t?void 0:t.value)}),[]),W=Object(o.useCallback)((function(e){var t;return l(null===(t=e.detail)||void 0===t?void 0:t.value)}),[]),G=Object(o.useCallback)((function(e){var t;return x(null===(t=e.detail)||void 0===t?void 0:t.value)}),[]),K=Object(o.useCallback)((function(e){var t;return L(null===(t=e.detail)||void 0===t?void 0:t.value)}),[]),V=(Object(o.useCallback)((function(){return I("")}),[]),Object(o.useCallback)(Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,de(k,v,n,s,O,P);case 2:e.sent,D.currentUser&&Y("Please verify your email address to finish signing up for Geogram","Thank you for signing in.");case 4:case"end":return e.stop()}}),e)}))),[k,v,n,s,O,P]));return Object(w.jsxs)(d.B,{children:[Object(w.jsx)(d.r,{children:Object(w.jsxs)(d.S,{children:[Object(w.jsx)(d.f,{slot:"start",children:Object(w.jsx)(d.e,{color:"primary",routerLink:"/login",children:Object(w.jsx)(d.s,{icon:R.g})})}),Object(w.jsx)(d.Q,{children:"Register"})]})}),Object(w.jsx)(d.n,{fullscreen:!0,children:Object(w.jsxs)(d.q,{children:[Object(w.jsx)("br",{}),Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"floating",children:"Username"}),Object(w.jsx)(d.u,{onIonChange:K,type:"text",value:P})]}),Object(w.jsx)("br",{}),Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"floating",children:"First Name"}),Object(w.jsx)(d.u,{onIonChange:W,type:"text",value:s})]}),Object(w.jsx)("br",{}),Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"floating",children:"Second Name"}),Object(w.jsx)(d.u,{onIonChange:G,type:"text",value:O})]}),Object(w.jsx)("br",{}),Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"floating",children:"Email"}),Object(w.jsx)(d.u,{onIonChange:M,type:"email",value:n})]}),Object(w.jsx)("br",{}),Object(w.jsxs)(d.v,{children:[Object(w.jsxs)(d.w,{position:"floating",children:["Password ",T]}),Object(w.jsx)(d.u,{onIonChange:q,type:"password",value:v})]}),Object(w.jsx)("br",{}),Object(w.jsxs)(d.v,{children:[Object(w.jsx)(d.w,{position:"floating",children:"Confirm Password "}),Object(w.jsx)(d.u,{onIonChange:Q,value:k,type:"password"})]}),Object(w.jsx)("br",{}),Object(w.jsx)("div",{className:"SignInButton",children:Object(w.jsxs)(d.e,{onClick:V,children:["Register",Object(w.jsx)(d.s,{icon:R.s})]})})]})})]})};function Oe(e,t){if(void 0!==e.distance&&void 0!==t.distance){if(e.distance>t.distance)return 1;if(e.distance<t.distance)return-1;if(e.location.timestamp<t.location.timestamp)return-1;if(e.location.timestamp>t.location.timestamp)return 1}return 0}function xe(e,t,n,r){var c=[];return console.log(e),t.forEach((function(t){var i=q(n,r,t.location.coords.latitude,t.location.coords.longitude);t.distance=i,i<=e&&c.push(t)})),c=c.sort((function(e,t){return Oe(e,t)})),console.log(c),c}var fe=x.f.Geolocation,pe=function(e){var t=e.setLoading,n=Object(o.useState)(),c=Object(r.a)(n,2),i=c[0],a=c[1],s=Object(o.useState)([]),l=Object(r.a)(s,2),b=l[0],h=l[1],O=Object(o.useState)(15),x=Object(r.a)(O,2),f=x[0],p=x[1],v=Object(o.useState)({open:!1,event:void 0}),m=Object(r.a)(v,2),g=m[0],y=m[1];function k(e){return S.apply(this,arguments)}function S(){return(S=Object(j.a)(u.a.mark((function e(t){var n,r,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=L.collection("images"),e.next=3,n.get();case 3:return r=e.sent,c=[],r.docs.forEach((function(e){return c.push(e.data())})),c=c.sort((function(e,t){return Oe(e,t)})),void 0!==i&&(c=xe(t||f,c,i.coords.latitude,i.coords.longitude)),e.abrupt("return",c);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}return Object(o.useEffect)((function(){Object(j.a)(u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=a,e.next=3,fe.getCurrentPosition();case 3:return e.t1=e.sent,(0,e.t0)(e.t1),console.log("Initial load..."),e.t2=h,e.next=9,k();case 9:e.t3=e.sent,(0,e.t2)(e.t3);case 11:case"end":return e.stop()}}),e)})))()}),[]),Object(w.jsxs)(d.B,{children:[Object(w.jsx)(d.r,{children:Object(w.jsxs)(d.S,{children:[Object(w.jsx)(d.Q,{children:"Explore"}),Object(w.jsxs)(d.O,{style:{marginRight:"0.25rem"},slot:"end",onClick:function(e){return y({open:!0,event:e.nativeEvent})},children:[f," km"]}),Object(w.jsx)(d.s,{style:{margin:"0.5rem"},icon:R.m,slot:"end",onClick:function(e){return y({open:!0,event:e.nativeEvent})}}),Object(w.jsx)(d.C,{isOpen:g.open,event:g.event,onDidDismiss:function(e){return y({open:!1,event:void 0})},children:Object(w.jsxs)(d.x,{children:[Object(w.jsx)(d.y,{children:"Range Filter"}),Object(w.jsx)(d.v,{children:Object(w.jsxs)(d.D,{min:0,max:30,snaps:!0,step:1,pin:!0,value:f,onIonChange:function(e){p(e.detail.value),t(!0),k(e.detail.value).then((function(e){h(e),t(!1)})).catch((function(e){return t(!1)}))},onLostPointerCapture:function(e){y({open:!1,event:void 0})},children:[Object(w.jsx)(d.w,{slot:"start",children:"0"}),Object(w.jsx)(d.w,{slot:"end",children:"30"})]})})]})})]})}),Object(w.jsxs)(d.n,{fullscreen:!0,children:[Object(w.jsx)(d.E,{slot:"fixed",onIonRefresh:function(e){console.log("Begin async operation"),k(f).then((function(e){return h(e)})),setTimeout((function(){console.log("Async operation has ended"),e.detail.complete()}),2e3)},pullFactor:.5,pullMin:100,pullMax:200,children:Object(w.jsx)(d.F,{})}),Object(w.jsx)(d.r,{collapse:"condense",children:Object(w.jsx)(d.S,{children:Object(w.jsx)(d.Q,{size:"large",children:"Explore"})})}),b.length>0&&b.map((function(e,t){return Object(w.jsx)(Q,{image:e},t)}))]})]})},ve=x.f.Filesystem,me=function(e){var t=Object(o.useContext)(Ce),n=Object(o.useState)(),c=Object(r.a)(n,2),i=c[0],l=c[1],b=Object(o.useState)("https://im-coder.com/images4/15590312779219.png"),O=Object(r.a)(b,2),f=O[0],p=O[1],v=Object(o.useState)(""),m=Object(r.a)(v,2),g=m[0],y=m[1],k=Object(o.useState)(""),S=Object(r.a)(k,2),E=S[0],P=S[1];Object(o.useEffect)((function(){void 0!==e.location.state&&l(e.location.state.image),L.collection("users").doc(null===t||void 0===t?void 0:t.uid).get().then((function(e){var t,n;(null===e||void 0===e||null===(t=e.data())||void 0===t?void 0:t.profilepic)?p(null===e||void 0===e||null===(n=e.data())||void 0===n?void 0:n.profilepic):p("https://im-coder.com/images4/15590312779219.png")})),e.setLoading(!1)}),[e.location.state]);var D=function(){var n=Object(j.a)(u.a.mark((function n(){var r,c;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(e.setLoading(!0),void 0===i){n.next=23;break}if(void 0===i.webviewPath){n.next=21;break}if(!Object(d.bb)("android")&&!Object(d.bb)("ios")){n.next=14;break}return n.t0=a.a,n.t1=Object(a.a)({},r),n.t2={},n.next=9,Object(h.a)(i.webviewPath);case 9:n.t3=n.sent.toString().split(",")[1],n.t4={data:n.t3},r=(0,n.t0)(n.t1,n.t2,n.t4),n.next=17;break;case 14:return n.next=16,ve.readFile({path:i.filepath,directory:x.d.Data,encoding:x.e.UTF8});case 16:r=n.sent;case 17:return n.next=19,C.a.post("".concat("https://api.dhbw-geogram.de","/upload1"),{data:r.data});case 19:void 0!==(c=n.sent).data.file?L.collection("users").doc(null===t||void 0===t?void 0:t.uid).get().then((function(n){L.collection("users").doc(null===t||void 0===t?void 0:t.uid).set(Object(a.a)(Object(a.a)({},n.data()),{},{profilepic:"".concat("https://api.dhbw-geogram.de","/")+c.data.file}),{merge:!0}).then((function(t){y("Successfully added item to firebase"),setTimeout((function(){P("profile"),e.setLoading(!1)}),100)})).catch((function(e){console.log("Error while changing profile picture")}))})):y("Error while adding data to image server: https://api.dhbw-geogram.de");case 21:n.next=24;break;case 23:y("Error occured!");case 24:case"end":return n.stop()}}),n)})));return function(){return n.apply(this,arguments)}}();return Object(w.jsxs)(d.B,{children:[Object(w.jsx)(d.r,{children:Object(w.jsx)(d.S,{children:Object(w.jsx)(d.Q,{children:"Upload"})})}),Object(w.jsxs)(d.n,{fullscreen:!0,children:[Object(w.jsx)(d.r,{collapse:"condense",children:Object(w.jsx)(d.S,{children:Object(w.jsx)(d.Q,{size:"large",children:"Upload"})})}),i&&Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)(d.q,{children:[Object(w.jsx)(d.J,{children:Object(w.jsx)(d.m,{children:Object(w.jsx)("h1",{children:"Change Profile Picture"})})}),Object(w.jsxs)(d.J,{children:[Object(w.jsx)(d.m,{size:"5",children:Object(w.jsx)(d.t,{src:f})}),Object(w.jsx)(d.m,{size:"2",style:{display:"flex",justifyContent:"center",alignItems:"center"},children:Object(w.jsx)(d.s,{style:{fontSize:"3em"},icon:R.b})}),Object(w.jsx)(d.m,{size:"5",children:Object(w.jsx)(d.t,{src:i.webviewPath})})]}),Object(w.jsx)("br",{}),Object(w.jsxs)(d.J,{children:[Object(w.jsx)(d.m,{size:"2",offset:"4",children:Object(w.jsx)(d.e,{expand:"block",shape:"round",fill:"outline",color:"primary",onClick:D,children:"Submit"})}),Object(w.jsx)(d.m,{size:"2",children:Object(w.jsx)(d.e,{expand:"block",shape:"round",fill:"outline",color:"danger",onClick:function(){p("https://im-coder.com/images4/15590312779219.png"),l(void 0),P("profile")},children:"Cancel"})})]})]})}),Object(w.jsx)(d.R,{isOpen:""!==g,onDidDismiss:function(){return y("")},message:g,duration:1500}),""!==E&&Object(w.jsx)(s.a,{to:"/".concat(E)})]})]})},ge=function(){return Object(w.jsxs)(N.a,{children:[Object(w.jsx)(s.b,{path:"/login",component:ce,exact:!0}),Object(w.jsx)(s.b,{path:"/register",component:he,exact:!0}),Object(w.jsx)(s.b,{path:"/",render:function(){return Object(w.jsx)(s.a,{to:"/login"})}})]})},ye=function(){var e=Object(o.useState)(!1),t=Object(r.a)(e,2),n=t[0],c=t[1],i=Object(o.useState)(!1),l=Object(r.a)(i,2),u=l[0],j=l[1];return Object(w.jsxs)(N.a,{children:[Object(w.jsxs)(d.N,{children:[Object(w.jsxs)(d.I,{children:[Object(w.jsx)(s.b,{exact:!0,path:"/explore",children:Object(w.jsx)(pe,{setLoading:j})}),Object(w.jsx)(s.b,{exact:!0,path:"/search",children:Object(w.jsx)(G,{})}),Object(w.jsx)(s.b,{path:"/profile",children:Object(w.jsx)(B,{setLoading:j})}),Object(w.jsx)(s.b,{exact:!0,path:"/",children:Object(w.jsx)(s.a,{to:"/explore"})}),Object(w.jsx)(s.b,{path:"/upload",render:function(e){return Object(w.jsx)(A,Object(a.a)(Object(a.a)({},e),{},{setLoading:j}))}}),Object(w.jsx)(s.b,{path:"/profile-pic",render:function(e){return Object(w.jsx)(me,Object(a.a)(Object(a.a)({},e),{},{setLoading:j}))}}),Object(w.jsx)(s.b,{exact:!0,path:"/login",children:Object(w.jsx)(s.a,{to:"/explore"})}),Object(w.jsx)(s.b,{exact:!0,path:"/register",children:Object(w.jsx)(s.a,{to:"/explore"})})]}),Object(w.jsxs)(d.L,{slot:"bottom",children:[Object(w.jsxs)(d.M,{tab:"explore",href:"/explore",children:[Object(w.jsx)(d.s,{icon:R.n}),Object(w.jsx)(d.w,{children:"Explore"})]}),Object(w.jsxs)(d.M,{tab:"search",href:"/search",children:[Object(w.jsx)(d.s,{icon:R.x}),Object(w.jsx)(d.w,{children:"Search"})]}),Object(w.jsxs)(d.M,{tab:"profile",href:"/profile",children:[Object(w.jsx)(d.s,{icon:R.t}),Object(w.jsx)(d.w,{children:"Profile"})]})]})]}),Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)(d.o,{style:{marginBottom:"4.5rem",marginRight:"0.5rem"},vertical:"bottom",horizontal:"end",slot:"fixed",onClick:function(){c(!0)},children:Object(w.jsx)(d.p,{children:Object(w.jsx)(d.s,{md:R.d,ios:R.c})})}),Object(w.jsx)(J,{active:n,setShowActionSheet:c,setLoading:j})]}),Object(w.jsx)(d.z,{isOpen:u,onDidDismiss:function(){return j(!1)},message:"Please wait...",duration:5e3})]})},we=function(){var e=Object(o.useContext)(Ce);return Object(w.jsx)(d.c,{children:e?Object(w.jsx)(ye,{}):Object(w.jsx)(ge,{})})};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ke=function(e){e&&e instanceof Function&&n.e(68).then(n.bind(null,225)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),r(e),c(e),i(e),a(e)}))},Se=n(92);Object(Se.a)(window);var Ce=Object(o.createContext)(null),Ee=function(e){var t=e.children,n=Object(o.useState)(null),c=Object(r.a)(n,2),i=c[0],a=c[1];return Object(o.useEffect)((function(){D.onAuthStateChanged((function(e){return a(e)}))}),[]),Object(w.jsxs)(Ce.Provider,{value:i,children:[" ",t,"    "]})};i.a.render(Object(w.jsx)(Ee,{children:Object(w.jsx)(we,{})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)})),ke()}},[[148,3,6]]]);
//# sourceMappingURL=main.7088ab83.chunk.js.map